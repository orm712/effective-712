# ITEM 24. 멤버 클래스는 되도록 static으로 만들라.

## 중첩 클래스란

중첩 클래스는 다른 클래스 안에 정의된 클래스이다. 자신을 감싼 바깥 클래스에서만 사용되어야 하고, 그 외에 쓰임새가 있다면 탑레벨 클래스로 만들어야 한다.

중첩 클래스의 종류는 다음과 같이 4가지가 있다.

1. 정적 멤버 클래스
2. 비정적 멤버 클래스
3. 익명 클래스
4. 지역 클래스

첫 번째를 제외한 나머지는 inner class이다.

## 정적 멤버 클래스

static inner class는 다른 클래스 안에 선언되고, 바깥 클래스의 private멤버에도 접근할 수 있다는 것 빼면 일반 클래스와 동일하다.
다른 정적 필드(멤버)와 같은 접근 규칙을 적용받는다. private로 선언 시 해당 클래스를 포함하는 외부 클래스에서만 접근이 가능하다.

정적 멤버 클래스는 흔히 바깥 클래스와 함께 쓰일 때 만 유용한 public 도우미 클래스로 쓰인다.

예시에서 보이듯 외부에서 계산기 클래스가 지원하는 연산 종류에 대한 enum을 참조할 수 있다.

정적 멤버 클래스와 비정적 멤버 클래스의 구문상 차이는 static이 붙고 안붙고 차이지만 의미상 차이는 꽤 크다.

### 비정적 멤버 클래스

비정적 멤버 클래스의 인스턴스는 바깥 클래스의 인스턴스와 암묵적으로 연결된다. 따라서 비정적 멤버 클래스의 인스턴스 메서드에서 정규화된 this를 이용해 바깥 인스턴스의 메서드를 호출하고, 바깥 인스턴스의 참조를
가져올 수 있다.

정규화된 this란 클래스명.this 형태로 바깥 클래스의 이름을 명시하는 용법이다. 따라서 개념상 중첩 클래스의 인스턴스가 바깥 인스턴스와 독립적으로 존재 가능하다면 정적으로 만들어야 한다. 비정적 멤버 클래스는
바깥 인스턴스 없이는 생성할 수 없기 때문이다.

비정적 멤버 클래스랑 바깥 클래스는 인스턴스 생성될 때 연결이 확립되고 더 이상 변경되지 않는다.
이 연결이 생기기 때문에 메모리를 차지하며, 생성 시간도 더 걸린다.

이 비정적 멤버 클래스는 어댑터를 정의할 때 자주 쓴다.

멤버 클래스에서 바깥 인스턴스에 접근할 일이 없다면 무조건 static 붙여서 정적 멤버 클래스로 만들자.
static을 안 쓰면 숨은 외부 참조가 생겨서 시간과 공간이 낭비된다. 게다가 GC가 직무유기한다. 이 참조는 게다가 안보여서 찾기 매우 빡세다

private 정적 멤버 클래스는 종종 바깥 클래스가 표현하는 객체의 한 부분(구성)을 나타낼때 쓴다.

키와 값을 매핑시키는 Map인스턴스에는 entry객체가 있다.
모든 엔트리가 맵과 연관되어 잇지만 직접 사용하지는 않는다.
따라서 비정적 멤버 클래스로 표현하는것은 낭비다. 바깥 맵을 참조할 필요가 없기 때문이다.

공개된 클래스의 public이나 protected멤버라면 static 붙이냐 마냐는 더 중요하다. 멤버 클래스 역시 외부에 노출되고 있을 것이기 때문에 혹시라도 향후 static 을 붙이면 밖에서 쓰던 놈들이 다
빨간줄뜬다.

### 익명 클래스

이름이 없다.
바깥 클래스의 멤버도 아니다.
쓰이는 시점에 선언과 동시에 인스턴스가 만들어진다.
코드의 어디서든 만들 수 있다.
비정적인 문맥에서 사용될 때만 바깥 클래스의 인스턴스를 참조할 수 있다.

응용하는데 좀 제약이 많은 편이다.
선언한 지점에서만 인스턴스를 만들 수 있고, instanceof나 클래스의 이름이 필요한 작업은 할 수 없다.

여러 인터페이스를 구현할 수 없다. 인터페이스 impl하면서 다른 클래스 extends를 할 수 없다.
익명클래스를 사용하는 클라이언트는 그 익명 클래스가 상위 타입에서 상속한 멤버 외에는 호출할 수 없다.

익명클래스는 표현식 중간에 등장하므로 짧지 않으면 가독성이 나락간다.

자바가 람다를 지원하기 전에는 익명클래스를 많이 썼으나, 이제 람다만쓴다. 가끔 정적 팩터리 메서드를 구현할 때 쓴다.

### 지역 클래스

뭐냐대체 나도모른다

지역 클래스는 지역변수를 선언할 수 있는 곳이면 어디든 선언할 수 있고 유효 범위도 지역변수와 같대.

다른 중첩 클래스들이랑 닮은점
익명클래스처럼 비정적 문맥에서 사용될 때만 바깥 인스턴스 참조가능,
정적 멤버는 가질 수 없음.
가독성을 위해 짧게 써야함

검색해봤는데
> 자바에서 지역 클래스(local class)는 메소드 내부 또는 다른 블록(예: if문, for문) 내부에서 정의되는 클래스입니다. 지역 클래스는 그것이 선언된 블록 내에서만 사용될 수 있으며, 이 클래스의 유효
> 범위는 지역 변수와 동일합니다.

난 어떻게 활용해야 잘 활용할 수 있을 지 모르겠지만 쓸모가있겠지

**핵심정리**
> 중첩 클래스에는 네 가지가 있으며 각각 쓰임이 다르다. 메서드 밖에서도 써야하거나 메서드 안에 정의하기 너무 길다면 멤버 클래스로 만든다.
> 멤버 클래스의 인스턴스 각각이 바깥 인스턴스를 참조한다면 static을 빼고, 그렇지 않으면 static을 넣고 만들자.
> 중첩 클래스가 한 메서드 안에만 쓰이고, 그 인스턴스 생성하는곳이 단 한곳에 타입으로 쓰기 적합한 클래스나 인터페이스가 이미 있다면 익명으로 만들고, 그렇지 않다면 지역 클래스로 만들자.
