# 람다보다는 메서드 참조를 사용하라

람다가 익명 클래스 대신해서 나왔고, 익명 클래스보다 자주 사용되는 이유중 가장 큰 것은 간결함이다.
그런데 람다보다 함수 객체를 더 간결하게 하는 방법이 있다. 바로 메서드 참조이다.

다음 코드는 임의의 키와 integer값 매핑을 관리하는 프로그램의 일부이다. 이때 값이 키의 인스턴스 갯수로 해석된다면 이 프로그램은 멀티셋을 궇녀한게 된다.
이 코드는 키가 맵 안에 없다면 키와 숫자 1을 매핑하고, 이미 있다면 기존 매핑 값 증가시킨다.

`map.merge(key, 1, (count, incr) -> count + incr;`

이 코드는 자바8에 Map에 추가된 merge를 사용한다. merge는 키, 값, 함수를 파라미터로 받으며, 주어진 키가 맵안에 아직 없다면 주어진 {키, 값} 쌍을 그대로 저장한다. 반대로 키가 이미 있다면 세
번째 인수로 받은 함수를 현재 값과 주어진 값에 적용한 다음 그 결과로 현재 값을 덮어쓴다. 즉 맵에 {키, 함수의 결과} 를 저장한다.

깔끔해 보이지만? 3번째 매개변수가 거추장스럽다. 이 람다는 두 인수의 합을 반환할 뿐인 아주 단순한 동작이다. 자바8부터 Integer의 정적 클래스가 위의 람다와 정확하게 동일하게 동작한다.
Integer.sum.

따라서 람다 대신 이 메소드의 레퍼런스를 전달하면 똑같은 결과를 더 보기좋게 만들 수 있다.

`map.merge(key, 1, Integer::sum);`

매개변수 수가 늘어날수록 메서드 참조로 깔끔해지는 양이 많아진다.

하지만 이 람다에서 제공하는 변수 이름으로 프로그래머들에게 좋은 가이드가 되는 경우도 있다. 이런 경우 람다가 코드는 더 길어지지만 메서드 참조보다 더 읽기 쉽고, 유지보수도 쉬울 수 있다.

람다로 할 수 없는 일은 메서드 참조로도 할 수 없다. 메서드 참조가 보통 더 간결하므로 람다로 구현할 때 너무 길거나 복잡하거나 가독성을 해친다면, 메서드 참조를 사용하는게 좋은 방식이다.
람다로 작성할 코드를 새로운 메서드에 담고, 람다 대신 그 메서드 참조를 사용하는것이다.

보통 IDE들은 람다를 메서드 참조로 대체하라고 노란줄을 띄울 것이다. IDE의 권고를 따르는게 보통은 이득이지만, 항상 그런 것은 아니다.
람다가 더 간결할 때가 가끔 있다. 메서드와 람다가 같은 클래스 안에 있을 때 보통 그렇다.
예를들어 다음 코드가 `GoshThisClassNameIsHumongous.class`안에 있을 때,

`service.execute(GoshThisClassNameIsHumongous::action);`
메서드 참조는 이렇게 된다.

이걸 람다로 쓰면

`service.execute(()->action())` 이렇게 된다.

메서드 참조의 유형은 다섯 가지 이다. 가장 흔한 유형이 앞에서 설명한 정적 메서드를 가리키는 참조이다. 나머지 네 유형을 알아보자.

### 인스턴스 메서드를 참조하는 유형

#### 수신 객체를 특정하는 한정적 인스턴스 메서드 참조

한정적 참조는 근본적으로 정적 참조와 비슷하다. 함수 객체가 받는 인수와 참조되는 메서드가 받는 인수가 똑같다.

#### 수신 객체를 특정하지 않는 비한정적 인스턴스 메서드 참조

비한정적 참조에서는 함수 객체를 적용하는 시점에 수신 객체를 알려준다. 이를 위해 수신 객체 전달용 파라미터가 파라미터 목록 첫 번째에 추가되고 그 뒤로는 참조되는 메서드 선언에 정의된 매개변수들이 이어진다.
비한정적 참조는 주로 스트림 파이프라인에서의 매핑과 필터 함수를 보면 바로 이해된다.

### 인스턴스 메서드를 참조하는게 아닌 유형

#### 클래스 생성자를 가리키는 메서드 참조

팩터리 객체로 사용된다.

#### 배열 생성자를 가리키는 메서드 참조

---
위의 5가지 참조를 정리하면

1. 정적 참조
    * Integer::parseInt
    * str -> Integer.parseInt(str)
2. 한정적 참조 (인스턴스)
    * Instant.now()::isAfter
    * `Instant then = Instant.now(); t -> then.isAfter(t)`
3. 비한정적 (인스턴스)
    * String::toLowerCase
    * str -> str.toLowerCase()
4. 클래스 생성자
    * TreeMap<K,V>::new
    * ()-> new TreeMap<K,V>()
5. 배열 생성자
    * int[]::new
    * len -> new int[len]

핵심정리
> 메서드 참조는 람다의 간단명료한 대안이 될 수 있다. 메서드 참조 쪽이 짧고, 누가 봐도 명확하다면 메서드 참조를 사용하라. 그렇지 않다면 람다를 사용하라
